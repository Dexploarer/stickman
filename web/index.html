<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Social Agent Studio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Anek+Latin:wght@400;500;600&family=JetBrains+Mono:wght@400;500&family=Manrope:wght@400;500;600;700&family=Outfit:wght@500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/tailwind.generated.css?v=tw-v1" />
    <link rel="stylesheet" href="/styles.css?v=ide-v3" />
  </head>
  <body class="tw-body">
    <div class="ambient"></div>
    <div id="desktop-drag-region" class="desktop-drag-region hidden" aria-hidden="true">
      <span class="desktop-drag-title">Prompt or Die Social Suite</span>
      <span id="desktop-drag-status" class="desktop-drag-status">Desktop shell inactive</span>
    </div>
    <main class="app-shell">
      <header class="hero">
        <div class="hero-content">
          <span class="hero-kicker">Social Agent Studio</span>
          <h1>Social Agent Studio</h1>
          <p>Command-first social operations workspace with full-size live observer and docked tool panes.</p>
        </div>
        <div class="hero-controls">
          <div class="chips hero-status">
            <span class="chip" id="health-chip">API: checking</span>
            <span class="chip" id="onboarding-chip">Onboarding: checking</span>
            <button class="ghost" id="refresh-health-btn" type="button">Refresh Status</button>
          </div>
          <p class="hero-note">Palette: Cmd/Ctrl+Shift+P â€¢ Context: Cmd/Ctrl+Shift+K</p>
        </div>
      </header>

      <section id="onboarding-root" class="stack onboarding-shell">
        <article class="panel">
          <h2>Onboarding</h2>
          <p class="summary">
            Configure OpenRouter models (text/image/video/embedding/voice), optional fallbacks, X credentials, and persona style before entering dashboard.
          </p>
          <form id="onboarding-form">
            <div class="split">
              <section>
                <h3>1) OpenRouter</h3>
                <label>API key (optional, required for AI features)</label>
                <input id="onb-api-key" type="password" />
                <div class="toggle-row">
                  <label><input id="onb-save-key" type="checkbox" /> save key locally</label>
                </div>
                <div class="button-row">
                  <button type="button" class="ghost" id="onb-test-key">Test Key</button>
                  <button type="button" class="ghost" id="onb-refresh-models">Fetch Models + Cache</button>
                </div>
                <label>Provider mode</label>
                <select id="onb-provider-mode">
                  <option value="openrouter">openrouter</option>
                  <option value="claude_subscription">claude_subscription</option>
                  <option value="hybrid">hybrid</option>
                </select>
                <div class="button-row">
                  <button type="button" class="ghost" id="onb-claude-login-start">Start Claude CLI Login</button>
                  <button type="button" class="ghost" id="onb-claude-check">Check Claude Session</button>
                </div>
                <pre id="onb-claude-output"></pre>
                <pre id="onb-key-output"></pre>
              </section>
              <section>
                <h3>2) X Account (Optional)</h3>
                <p class="summary">Leave username/password empty to validate your existing local browser X session.</p>
                <label>X username</label>
                <input id="onb-x-username" type="text" placeholder="your_handle" />
                <label>X password</label>
                <input id="onb-x-password" type="password" />
                <label>X email</label>
                <input id="onb-x-email" type="text" />
                <div class="toggle-row">
                  <label><input id="onb-save-x-password" type="checkbox" /> save password locally</label>
                </div>
                <div class="toggle-row">
                  <label><input id="onb-x-extension-enabled" type="checkbox" checked /> enable x-social extension</label>
                </div>
                <label>Extension mode</label>
                <select id="onb-x-extension-mode">
                  <option value="manual">manual</option>
                  <option value="scheduled">scheduled</option>
                </select>
                <div class="toggle-row">
                  <label><input id="onb-x-approval-write" type="checkbox" checked /> require approval for write/auth actions</label>
                </div>
                <div class="button-row">
                  <button type="button" class="ghost" id="onb-test-x-login">Test X Session / Login</button>
                </div>
                <pre id="onb-x-output"></pre>
              </section>
            </div>

            <h3>3) Model Defaults and Fallbacks (All Optional)</h3>
            <div class="grid-4">
              <div class="sub-panel">
                <label>Text small</label>
                <select id="onb-model-text-small"></select>
                <label>Text large</label>
                <select id="onb-model-text-large"></select>
                <label>Text fallback</label>
                <select id="onb-model-text-fallback"></select>
              </div>
              <div class="sub-panel">
                <label>Image primary</label>
                <select id="onb-model-image-primary"></select>
                <label>Image fallback</label>
                <select id="onb-model-image-fallback"></select>
              </div>
              <div class="sub-panel">
                <label>Video primary</label>
                <select id="onb-model-video-primary"></select>
                <label>Video fallback</label>
                <select id="onb-model-video-fallback"></select>
              </div>
              <div class="sub-panel">
                <label>Embedding primary</label>
                <select id="onb-model-embedding-primary"></select>
                <label>Embedding fallback</label>
                <select id="onb-model-embedding-fallback"></select>
              </div>
              <div class="sub-panel">
                <label>Voice primary</label>
                <select id="onb-model-voice-primary"></select>
                <label>Voice fallback</label>
                <select id="onb-model-voice-fallback"></select>
              </div>
            </div>

            <h3>4) Agent Persona</h3>
            <div class="split">
              <section>
                <label>Style prompt</label>
                <textarea id="onb-style-prompt" rows="3"></textarea>
                <label>Voice style</label>
                <input id="onb-voice-style" type="text" placeholder="concise, confident, tactical" />
              </section>
              <section>
                <label>Persona source mode</label>
                <select id="onb-derive-mode">
                  <option value="manual">manual</option>
                  <option value="active_profile">active_profile</option>
                  <option value="x_username">x_username</option>
                  <option value="x_url">x_url</option>
                </select>
                <label>Source value (username or URL if needed)</label>
                <input id="onb-source-value" type="text" />
                <div class="toggle-row">
                  <label><input id="onb-auto-derive" type="checkbox" /> auto-derive persona</label>
                </div>
                <div class="button-row">
                  <button type="button" class="ghost" id="onb-derive-persona">Derive Persona</button>
                </div>
              </section>
            </div>
            <pre id="onb-persona-output"></pre>

            <h3>5) Local Key Import (Explicit Permission)</h3>
            <div class="split">
              <section>
                <div class="toggle-row">
                  <label><input id="onb-import-allow" type="checkbox" /> allow local env/config read for this import</label>
                </div>
                <div class="toggle-row">
                  <label><input id="onb-import-env" type="checkbox" /> include process env (`process.env`)</label>
                </div>
                <div class="toggle-row">
                  <label><input id="onb-import-home" type="checkbox" checked /> include home defaults (`~/.config`, `~/.claude`, `~/.codex`)</label>
                </div>
                <div class="toggle-row">
                  <label><input id="onb-import-shell" type="checkbox" /> include shell profiles (`~/.zshrc`, `~/.bashrc`)</label>
                </div>
                <div class="toggle-row">
                  <label><input id="onb-import-claude" type="checkbox" checked /> include Claude auth/config files</label>
                </div>
                <div class="toggle-row">
                  <label><input id="onb-import-override" type="checkbox" /> override existing onboarding values</label>
                </div>
              </section>
              <section>
                <label>Additional file paths (one per line, optional)</label>
                <textarea
                  id="onb-import-paths"
                  rows="5"
                  placeholder="~/.config/prompt-or-die/.env&#10;~/.claude/auth.json"
                ></textarea>
                <div class="toggle-row">
                  <label><input id="onb-import-export" type="checkbox" /> export Prompt or Die env after import</label>
                </div>
                <div class="button-row">
                  <button type="button" class="ghost" id="onb-import-local">Import Local Secrets</button>
                </div>
              </section>
            </div>
            <pre id="onb-import-output"></pre>

            <h3>6) Prompt or Die Config Export</h3>
            <div class="split">
              <section>
                <div class="toggle-row">
                  <label><input id="onb-pordie-enabled" type="checkbox" /> enable `.pordie` config folder</label>
                </div>
                <label>Config scope</label>
                <select id="onb-pordie-scope">
                  <option value="global">global (~/.pordie)</option>
                  <option value="project">project (./.pordie)</option>
                </select>
                <div class="toggle-row">
                  <label><input id="onb-pordie-auto-export" type="checkbox" /> auto-export on onboarding complete</label>
                </div>
                <div class="toggle-row">
                  <label><input id="onb-pordie-sync-env" type="checkbox" /> also sync values into project `.env`</label>
                </div>
                <div class="button-row">
                  <button type="button" class="ghost" id="onb-export-now">Export Prompt or Die Env Now</button>
                </div>
              </section>
              <section>
                <p class="summary">
                  Export target files:
                </p>
                <p class="summary" id="onb-pordie-target">- scope: global (~/.pordie)</p>
                <p class="summary">- `config.json`</p>
                <p class="summary">- `.env`</p>
                <p class="summary">- `env.sh` (source in terminal)</p>
              </section>
            </div>
            <pre id="onb-pordie-output"></pre>

            <h3>7) Autonomy Guardrails</h3>
            <div class="split">
              <section>
                <div class="toggle-row">
                  <label><input id="onb-autonomy-enabled" type="checkbox" /> enable autonomy loop</label>
                </div>
                <label>Policy</label>
                <select id="onb-autonomy-policy">
                  <option value="mixed_auto">mixed_auto</option>
                </select>
              </section>
              <section>
                <label>Max actions per cycle</label>
                <input id="onb-autonomy-max-actions" type="number" min="1" max="30" value="8" />
                <label>Approval TTL (minutes)</label>
                <input id="onb-autonomy-approval-ttl" type="number" min="1" max="240" value="30" />
              </section>
            </div>

            <h3>8) Agent Skills + Mac Control + Watch</h3>
            <div class="split">
              <section>
                <label>App allowlist</label>
                <div class="toggle-row">
                  <label><input id="onb-app-antigravity" type="checkbox" checked /> Antigravity</label>
                  <label><input id="onb-app-chrome" type="checkbox" checked /> Chrome</label>
                </div>
                <label>Require approval categories</label>
                <div class="toggle-row">
                  <label><input id="onb-approval-app-launch" type="checkbox" /> app_launch</label>
                  <label><input id="onb-approval-browser-external" type="checkbox" checked /> browser_external</label>
                  <label><input id="onb-approval-write-command" type="checkbox" checked /> write_command</label>
                </div>
              </section>
              <section>
                <div class="toggle-row">
                  <label><input id="onb-watch-enabled" type="checkbox" checked /> enable live screenshare watch</label>
                </div>
                <label>Watch FPS</label>
                <input id="onb-watch-fps" type="number" min="1" max="6" value="2" />
                <label>Capture Scope</label>
                <input id="onb-watch-scope" type="text" value="agent_surfaces_only" readonly />
              </section>
            </div>

            <div class="button-row">
              <button type="submit">Finish Onboarding and Enter Dashboard</button>
              <button type="button" class="ghost" id="onb-save-draft">Save Draft</button>
            </div>
          </form>
        </article>
      </section>

      <section id="dashboard-root" class="ide-shell hidden dashboard-shell">
        <header class="ide-topbar">
          <div class="ide-topbar-left">
            <strong class="ide-topbar-title">Social Agent Studio</strong>
            <span id="ide-top-health" class="ide-pill">API: checking</span>
          </div>
          <div class="ide-topbar-right">
            <span class="ide-pill ide-pill-cost">$0.24</span>
            <span class="ide-pill ide-pill-running">running</span>
            <span id="ide-top-onboarding" class="ide-pill">Onboarding: checking</span>
            <button class="ghost ide-toolbar-btn ide-icon-btn" type="button" id="ide-runtime-pause" title="Pause refresh loop">II</button>
            <button class="ghost ide-toolbar-btn ide-icon-btn" type="button" id="ide-runtime-restart" title="Refresh all systems">Restart</button>
            <button class="ghost ide-toolbar-btn ide-icon-btn" type="button" id="ide-toggle-left" title="Tools drawer">Tools</button>
            <button class="ghost ide-toolbar-btn ide-icon-btn" type="button" id="ide-toggle-right" title="Autonomous loop rail">Loop</button>
            <button class="ghost ide-toolbar-btn ide-icon-btn" type="button" id="ide-toggle-bottom" title="Output drawer">Output</button>
            <button class="ghost ide-toolbar-btn ide-icon-btn" type="button" id="context-send-btn" title="Send context">Cmd+K</button>
          </div>
        </header>

        <nav id="ide-activity-rail" class="ide-activity-rail ide-nav-row" aria-label="Navigation">
          <button class="ide-activity-btn active" type="button" data-ide-activity="chat" title="Chat" aria-label="Chat">Chat</button>
          <button class="ide-activity-btn" type="button" data-ide-activity="agent" title="Agent" aria-label="Agent">Agent</button>
          <button class="ide-activity-btn" type="button" data-ide-activity="memory" title="Memory" aria-label="Memory">Memory</button>
          <button class="ide-activity-btn" type="button" data-ide-activity="tools" title="Tools" aria-label="Tools">Tools</button>
          <button class="ide-activity-btn" type="button" data-ide-activity="integrations" title="Integrations" aria-label="Integrations">Integrations</button>
          <button class="ide-activity-btn" type="button" data-ide-activity="workflows" title="Workflows" aria-label="Workflows">Workflows</button>
          <button class="ide-activity-btn" type="button" data-ide-activity="settings" title="Settings" aria-label="Settings">Settings</button>
          <button class="ide-activity-btn" type="button" data-ide-activity="advanced" title="Advanced" aria-label="Advanced">Advanced</button>
        </nav>

        <div class="ide-workspace">
          <aside id="ide-left-dock" class="stack ide-dock ide-left-dock ide-sidebar">
          <div id="ide-left-tabs" class="ide-tabbar" role="tablist" aria-label="Operations panes"></div>
          <article id="runtime-controls-panel" class="panel" data-ide-pane data-ide-label="Runtime">
            <h2>Runtime Controls</h2>
            <div class="field-grid">
              <label>Browser</label>
              <select id="cfg-browser">
                <option value="chrome">chrome</option>
                <option value="chromium">chromium</option>
                <option value="edge">edge</option>
              </select>

              <label>Compatibility</label>
              <select id="cfg-compat">
                <option value="none">none</option>
                <option value="aisa">aisa</option>
              </select>

              <label>Chrome profile path</label>
              <input id="cfg-profile" type="text" placeholder="/Users/.../Chrome" />

              <label>Chrome profile name</label>
              <input id="cfg-profile-name" type="text" value="Default" />

              <label>Notify webhook</label>
              <input id="cfg-webhook" type="text" placeholder="https://..." />
            </div>
            <div class="toggle-row">
              <label><input id="cfg-visible" type="checkbox" /> visible browser</label>
              <label><input id="cfg-notify" type="checkbox" /> local notifications</label>
            </div>
            <div class="button-row">
              <button class="ghost" type="button" id="open-onboarding-btn">Reopen Onboarding</button>
            </div>
            <h3>Model Lanes</h3>
            <pre id="model-lanes-output"></pre>
            <h3>Heartbeat Agent</h3>
            <div class="button-row">
              <button class="ghost" type="button" id="heartbeat-refresh">Refresh Heartbeat</button>
              <button class="ghost" type="button" id="heartbeat-run-now">Run Heartbeat Now</button>
            </div>
            <pre id="heartbeat-output"></pre>
            <h3>Provider Route</h3>
            <div class="button-row">
              <button class="ghost" type="button" id="provider-refresh">Refresh Provider Status</button>
            </div>
            <pre id="provider-status-output"></pre>
            <h3>Integration Control Plane</h3>
            <div class="button-row">
              <button class="ghost" type="button" id="integrations-refresh">Refresh Integrations</button>
              <button class="ghost" type="button" id="integration-open-antigravity">Open Antigravity</button>
              <button class="ghost" type="button" id="integration-open-chrome">Open Chrome</button>
            </div>
            <div id="integration-badges" class="integration-badges"></div>
            <pre id="integrations-output"></pre>
            <h3>Integration Actions</h3>
            <label>Runbook</label>
            <select id="integration-runbook-select"></select>
            <label>Action Parameters</label>
            <textarea id="integration-params-json" rows="4" placeholder='{"sourceId":"embedded-browser","fps":2}'></textarea>
            <label>Confirm token</label>
            <input id="integration-confirm-token" type="text" placeholder="dry-run token appears here" />
            <div class="button-row">
              <button class="ghost" type="button" id="integration-actions-refresh">Refresh Catalog</button>
              <button class="ghost" type="button" id="integration-action-dry-run">Dry Run</button>
              <button class="ghost" type="button" id="integration-action-execute">Execute</button>
              <button class="ghost" type="button" id="integration-actions-history-refresh">Refresh History</button>
            </div>
            <pre id="integration-action-output"></pre>
            <pre id="integration-actions-history-output"></pre>
            <h3>Bridge Subscribers</h3>
            <label>Subscriber URL</label>
            <input id="integration-sub-url" type="text" placeholder="https://example.com/webhooks/stickman" />
            <label>Events CSV</label>
            <input id="integration-sub-events" type="text" value="integration_*" />
            <label>Subscriber ID</label>
            <input id="integration-sub-id" type="text" placeholder="subscriber id for enable/disable/test/delete" />
            <div class="button-row">
              <button class="ghost" type="button" id="integration-subs-refresh">Refresh Subs</button>
              <button class="ghost" type="button" id="integration-sub-create">Create</button>
              <button class="ghost" type="button" id="integration-sub-enable">Enable</button>
              <button class="ghost" type="button" id="integration-sub-disable">Disable</button>
              <button class="ghost" type="button" id="integration-sub-test">Test</button>
              <button class="ghost" type="button" id="integration-sub-delete">Delete</button>
            </div>
            <pre id="integration-subs-output"></pre>
            <h3>Bridge Status</h3>
            <div class="button-row">
              <button class="ghost" type="button" id="integration-bridge-refresh">Refresh Bridge</button>
              <button class="ghost" type="button" id="integration-control-token">Mint Control Room Token</button>
            </div>
            <pre id="integration-bridge-output"></pre>
            <h3>Extensions</h3>
            <div class="button-row">
              <button class="ghost" type="button" id="ext-x-enable">Enable X Extension</button>
              <button class="ghost" type="button" id="ext-x-disable">Disable X Extension</button>
              <button class="ghost" type="button" id="ext-refresh">Refresh Extensions</button>
            </div>
            <pre id="extensions-output"></pre>
            <h3>Autonomy + Approvals</h3>
            <div class="button-row">
              <button class="ghost" type="button" id="autonomy-enable">Enable</button>
              <button class="ghost" type="button" id="autonomy-disable">Disable</button>
              <button class="ghost" type="button" id="autonomy-refresh">Refresh</button>
            </div>
            <pre id="autonomy-output"></pre>
          </article>

          <article id="quick-automations-panel" class="panel" data-ide-pane data-ide-label="Automations">
            <h2>Quick Automations</h2>
            <div class="button-grid">
              <button type="button" id="qa-session">Session Sanity Check</button>
              <button type="button" id="qa-discovery">Discovery Sweep</button>
              <button type="button" id="qa-trendscan">Trend Scan</button>
            </div>
            <pre id="quick-output"></pre>
          </article>

          <article id="memory-tools-panel" class="panel" data-ide-pane data-ide-label="Memory Tools">
            <h2>Memory Tools</h2>
            <p class="summary">Capture context, transform it, and route into planner/mission/command flows.</p>
            <div class="button-grid">
              <button class="ghost" type="button" data-utility-proxy="utility-source-use-selection">Use Selection</button>
              <button class="ghost" type="button" data-utility-proxy="utility-source-use-latest">Use Latest</button>
              <button class="ghost" type="button" data-context-transform="tighten">Tighten</button>
              <button class="ghost" type="button" data-context-transform="threadify">Threadify</button>
              <button class="ghost" type="button" data-context-transform="cta">CTA Variant</button>
              <button class="ghost" type="button" data-utility-proxy="utility-prefill-planner">Prefill Planner</button>
              <button class="ghost" type="button" data-utility-proxy="utility-prefill-mission">Prefill Mission</button>
              <button class="ghost" type="button" data-utility-proxy="utility-prefill-command">Prefill Command</button>
              <button class="ghost" type="button" data-utility-proxy="utility-archive-knowledge">Archive Knowledge</button>
            </div>
          </article>

          <article id="tools-drawer-panel" class="panel" data-ide-pane data-ide-label="Tool Presets">
            <h2>Tool Presets</h2>
            <p class="summary">Quick-run command studio endpoints with one click.</p>
            <label>Endpoint preset</label>
            <select id="tools-preset-select">
              <option value="trends">trends</option>
              <option value="search">search</option>
              <option value="stream_status">stream_status</option>
              <option value="get_my_x_account_detail_v3">get_my_x_account_detail_v3</option>
            </select>
            <div class="button-row">
              <button class="ghost" type="button" id="tools-preset-run">Run Preset</button>
              <button class="ghost" type="button" id="tools-preset-open-live">Expand Live Viewer</button>
            </div>
            <pre id="tools-drawer-output">Tool presets ready.</pre>
          </article>

          <article id="integrations-drawer-panel" class="panel" data-ide-pane data-ide-label="Integrations Control">
            <h2>Integrations Control</h2>
            <p class="summary">Bridge/subscriber/livekit actions with direct runtime hooks.</p>
            <div class="button-grid">
              <button class="ghost" type="button" data-utility-proxy="integrations-refresh">Refresh Integrations</button>
              <button class="ghost" type="button" data-utility-proxy="integration-bridge-refresh">Refresh Bridge</button>
              <button class="ghost" type="button" data-utility-proxy="integration-subs-refresh">Refresh Subscribers</button>
              <button class="ghost" type="button" data-utility-proxy="livekit-refresh">Refresh LiveKit</button>
              <button class="ghost" type="button" data-utility-proxy="integration-open-antigravity">Open Antigravity</button>
              <button class="ghost" type="button" data-utility-proxy="integration-open-chrome">Open Chrome</button>
            </div>
          </article>

          <article id="workflows-drawer-panel" class="panel" data-ide-pane data-ide-label="Workflow Tools">
            <h2>Workflow Tools</h2>
            <p class="summary">Mission templates and task automation shortcuts.</p>
            <div class="button-grid">
              <button class="ghost" type="button" data-utility-proxy="cowork-mission-run">Run Selected Mission</button>
              <button class="ghost" type="button" data-utility-proxy="cowork-mission-social">Run Social Mission</button>
              <button class="ghost" type="button" data-utility-proxy="plan-import">Import Plan to Runner</button>
              <button class="ghost" type="button" data-utility-proxy="workflow-run">Run Workflow Script</button>
              <button class="ghost" type="button" data-utility-proxy="tasks-refresh">Refresh Task Board</button>
            </div>
          </article>

          <article id="advanced-drawer-panel" class="panel" data-ide-pane data-ide-label="Advanced Controls">
            <h2>Advanced Controls</h2>
            <p class="summary">Dev workbench operations and approval management shortcuts.</p>
            <div class="button-grid">
              <button class="ghost" type="button" data-utility-proxy="dev-workspace-tree-refresh">Refresh Workspace Tree</button>
              <button class="ghost" type="button" data-utility-proxy="dev-git-refresh">Refresh Git</button>
              <button class="ghost" type="button" data-utility-proxy="dev-terminal-refresh">Refresh Terminal Sessions</button>
              <button class="ghost" type="button" data-utility-proxy="approvals-refresh">Refresh Approvals</button>
              <button class="ghost" type="button" data-utility-proxy="integration-actions-refresh">Refresh Integration Actions</button>
            </div>
          </article>

          <article id="layout-generator-panel" class="panel" data-ide-pane data-ide-label="Layout">
            <h2>Layout Generator</h2>
            <p class="summary">
              Generate dashboard panels from a JSON Render custom-schema `layout + columns + widgets` spec (social/X focused) and apply them to the workbench.
            </p>
            <label>Generation prompt</label>
            <textarea
              id="dashboard-json-render-prompt"
              rows="4"
              placeholder="Build a high-velocity social ops dashboard for X trend capture, post drafting, and mission execution."
            ></textarea>
            <div class="button-row">
              <button class="ghost" type="button" id="dashboard-json-render-generate">Generate Spec</button>
              <button class="ghost" type="button" id="dashboard-json-render-apply">Apply + Reload</button>
              <button class="ghost" type="button" id="dashboard-json-render-clear">Clear Generated Panels</button>
            </div>
            <pre id="dashboard-json-render-output"></pre>
          </article>

          <article id="recent-runs-panel" class="panel" data-ide-pane data-ide-label="Runs">
            <h2>Recent Runs</h2>
            <div id="history-list" class="history-list"></div>
          </article>

          <article id="approval-queue-panel" class="panel" data-ide-pane data-ide-label="Approvals">
            <h2>Approval Queue</h2>
            <label>Approval ID</label>
            <input id="approval-id" type="text" placeholder="paste approval id" />
            <div class="button-row">
              <button class="ghost" type="button" id="approvals-refresh">Refresh Queue</button>
              <button class="ghost" type="button" id="approval-approve">Approve</button>
              <button class="ghost" type="button" id="approval-reject">Reject</button>
            </div>
            <pre id="approvals-output"></pre>
          </article>

          <article id="skill-center-panel" class="panel" data-ide-pane data-ide-label="Skills">
            <h2>Skill Center</h2>
            <label>Skill</label>
            <select id="skill-select"></select>
            <label>Skill Parameters</label>
            <textarea id="skill-args" rows="4" placeholder='{"prompt":"Analyze this repo"}'></textarea>
            <div class="button-row">
              <button class="ghost" type="button" id="skills-refresh">Refresh Skills</button>
              <button class="ghost" type="button" id="skill-enable">Enable Skill</button>
              <button class="ghost" type="button" id="skill-disable">Disable Skill</button>
              <button type="button" id="skill-run">Run Skill</button>
            </div>
            <pre id="skills-output"></pre>
          </article>

          <article id="task-board-panel" class="panel" data-ide-pane data-ide-label="Tasks">
            <h2>Task Board</h2>
            <form id="task-create-form">
              <label>Prompt / Mission</label>
              <textarea id="task-prompt" rows="3" placeholder="Open Antigravity and prep a social mission context."></textarea>
              <label>Optional skill route</label>
              <select id="task-skill-select"></select>
              <label>Depends on Task ID (optional)</label>
              <input id="task-depends-on" type="text" placeholder="run only after dependency completes" />
              <button type="submit">Create Task</button>
            </form>
            <label>Task ID</label>
            <input id="task-id" type="text" placeholder="paste task id" />
            <div class="button-row">
              <button class="ghost" type="button" id="tasks-refresh">Refresh Tasks</button>
              <button class="ghost" type="button" id="task-retry">Retry Task</button>
              <button class="ghost" type="button" id="task-watch">Watch Task</button>
              <button class="ghost" type="button" id="task-cancel">Cancel Task</button>
            </div>
            <pre id="tasks-output"></pre>
          </article>

          <article id="mac-watch-panel" class="panel" data-ide-pane data-ide-label="Watch">
            <h2>Mac Allowlist + Watch</h2>
            <div class="toggle-row">
              <label><input id="mac-allow-antigravity" type="checkbox" checked /> allow antigravity</label>
              <label><input id="mac-allow-chrome" type="checkbox" checked /> allow chrome</label>
            </div>
            <div class="button-row">
              <button class="ghost" type="button" id="mac-policy-save">Save Mac Policy</button>
            </div>
            <label>App</label>
            <select id="mac-app-select">
              <option value="antigravity">antigravity</option>
              <option value="chrome">chrome</option>
            </select>
            <label>Optional URL</label>
            <input id="mac-app-url" type="text" placeholder="antigravity://mission/123 or https://example.com" />
            <div class="button-row">
              <button class="ghost" type="button" id="mac-apps-refresh">Refresh Mac Apps</button>
              <button class="ghost" type="button" id="mac-open-app">Open App</button>
              <button class="ghost" type="button" id="mac-focus-app">Focus App</button>
            </div>
            <label>Watch Source</label>
            <select id="watch-source-select">
              <option value="embedded-browser">embedded-browser</option>
              <option value="antigravity">antigravity</option>
              <option value="chrome">chrome</option>
            </select>
            <label>Watch FPS</label>
            <input id="watch-fps" type="number" min="1" max="6" value="2" />
            <label>Active Watch Session</label>
            <select id="watch-session-select">
              <option value="">auto (most recent active)</option>
            </select>
            <label>Watch Session ID</label>
            <input id="watch-session-id" type="text" placeholder="watch session id" />
            <div class="button-row">
              <button class="ghost" type="button" id="watch-sources-refresh">Refresh Watch Sources</button>
              <button class="ghost" type="button" id="watch-start">Start Watch</button>
              <button class="ghost" type="button" id="watch-stop">Stop Watch</button>
              <button class="ghost" type="button" id="watch-expand-live">Expand Live Viewer</button>
            </div>
            <h3>LiveKit Remote Bridge (Optional)</h3>
            <div class="toggle-row">
              <label><input id="livekit-enabled" type="checkbox" /> enable livekit remote transport</label>
            </div>
            <label>LiveKit WS URL</label>
            <input id="livekit-ws-url" type="text" placeholder="wss://your-livekit-host" />
            <label>LiveKit API Key</label>
            <input id="livekit-api-key" type="text" placeholder="LIVEKIT_API_KEY" />
            <label>Room Prefix</label>
            <input id="livekit-room-prefix" type="text" placeholder="milady-cowork" />
            <label>Stream Mode</label>
            <select id="livekit-stream-mode">
              <option value="events_only">events_only</option>
              <option value="events_and_frames">events_and_frames</option>
            </select>
            <div class="button-row">
              <button class="ghost" type="button" id="livekit-refresh">Refresh LiveKit</button>
              <button class="ghost" type="button" id="livekit-save">Save LiveKit</button>
              <button class="ghost" type="button" id="livekit-token">Mint Viewer Token</button>
            </div>
            <pre id="livekit-output"></pre>
            <pre id="mac-policy-output"></pre>
          </article>
          </aside>

          <section class="ide-editor-surface">
            <header class="ide-view-header">
              <div>
                <strong id="ide-view-title">Chat</strong>
                <p id="ide-view-subtitle">Co-work chat with direct command dispatch and focused interaction.</p>
              </div>
              <div class="ide-view-actions">
                <button class="ghost" type="button" id="ide-view-refresh">Refresh View Data</button>
              </div>
            </header>
            <section id="ide-main-dock" class="stack ide-dock ide-main-dock ide-editor">
              <div id="ide-main-tabs" class="ide-tabbar ide-main-tabbar" role="tablist" aria-label="Workspace panes"></div>
          <article id="cowork-panel" class="panel cowork-panel" data-ide-pane data-ide-label="Co-Work">
            <h2>Agentic Co-Workspace</h2>
            <p class="summary">
              Claude-code style three-lane cowork surface: conversations, command/task dispatch, and live observer stream.
            </p>
            <div class="cowork-toolbar">
              <button class="ghost" type="button" id="cowork-focus-toggle">Enable Focus Mode</button>
              <button class="ghost" type="button" id="cowork-advanced-toggle">Show Advanced Panels</button>
              <span class="cowork-toolbar-hint">Slash commands: /status /help /new /compact /watch</span>
            </div>
            <div class="cowork-grid">
              <section class="cowork-lane">
                <button class="cowork-new-chat-btn" type="button" id="cowork-new-chat">+ New Chat</button>
                <h3>Conversations</h3>
                <div id="cowork-conversations" class="history-list"></div>
              </section>
              <section class="cowork-lane">
                <h3>Agent Chat + Task Dispatch</h3>
                <div id="cowork-shell-banner" class="cowork-shell-banner"></div>
                <div class="cowork-command-bar">
                  <button class="ghost cowork-command-btn" type="button" data-cowork-command="/status">/status</button>
                  <button class="ghost cowork-command-btn" type="button" data-cowork-command="/help">/help</button>
                  <button class="ghost cowork-command-btn" type="button" data-cowork-command="/new">/new</button>
                  <button class="ghost cowork-command-btn" type="button" data-cowork-command="/compact">/compact</button>
                  <button class="ghost cowork-command-btn" type="button" data-cowork-command="/watch">/watch</button>
                </div>
                <div id="cowork-metrics" class="cowork-metrics"></div>
                <div id="cowork-chat-log" class="cowork-chat-log"></div>
                <form id="cowork-form">
                  <div class="cowork-mode-row">
                    <span>MODE</span>
                    <button class="ghost cowork-mode-btn active" type="button" data-cowork-mode="simple">Simple</button>
                    <button class="ghost cowork-mode-btn" type="button" data-cowork-mode="power">Power</button>
                  </div>
                  <label>Task for Agent</label>
                  <textarea id="cowork-task-input" rows="4" placeholder="Ask directly, or use slash commands (/status, /watch)." required></textarea>
                  <div class="toggle-row">
                    <label><input id="cowork-auto-plan" type="checkbox" checked /> also generate automation plan</label>
                    <label><input id="cowork-start-task" type="checkbox" checked /> queue as background task</label>
                  </div>
                  <div class="button-row">
                    <button type="submit">Send Task</button>
                    <button class="ghost" type="button" id="cowork-clear-chat">Clear Chat</button>
                  </div>
                </form>
                <pre id="cowork-output"></pre>
                <pre id="cowork-state-output"></pre>

                <div class="sub-panel cowork-advanced-panel">
                  <h3>Quick Agent Skills</h3>
                  <p class="summary">Launch core agent actions with one click while keeping approval controls intact.</p>
                  <label>Quick URL (for browser action)</label>
                  <input id="cowork-quick-url" type="text" placeholder="https://x.com/home" />
                  <label>Quick Prompt (for social mission/context)</label>
                  <input id="cowork-quick-prompt" type="text" placeholder="Draft social strategy for today." />
                  <div class="button-grid cowork-quick-grid">
                    <button class="ghost" type="button" id="cowork-quick-antigravity">Open Antigravity</button>
                    <button class="ghost" type="button" id="cowork-quick-chrome">Open Chrome</button>
                  </div>
                </div>

                <div class="sub-panel cowork-advanced-panel">
                  <h3>Mission Templates</h3>
                  <p class="summary">Create social mission chains in one click.</p>
                  <label>Mission Template</label>
                  <select id="cowork-mission-select"></select>
                  <label>Prompt override (optional)</label>
                  <input id="cowork-mission-prompt" type="text" placeholder="Override mission objective..." />
                  <label>Social query override (optional)</label>
                  <input id="cowork-mission-query" type="text" placeholder="AI agents trend" />
                  <div class="button-row">
                    <button class="ghost" type="button" id="cowork-mission-run">Run Selected Mission</button>
                    <button class="ghost" type="button" id="cowork-mission-social">Run Social Mission</button>
                  </div>
                </div>

                <div class="sub-panel cowork-advanced-panel">
                  <h3>Active Task Board</h3>
                  <div id="cowork-task-board" class="cowork-task-board"></div>
                </div>

                <div class="sub-panel cowork-advanced-panel">
                  <h3>Task Log Tail</h3>
                  <label>Task ID</label>
                  <select id="cowork-log-task-select"></select>
                  <label>Log Type Filter</label>
                  <select id="cowork-log-type-filter">
                    <option value="">all</option>
                    <option value="task_state">task_state</option>
                    <option value="skill_action">skill_action</option>
                    <option value="stdout_chunk">stdout_chunk</option>
                    <option value="frame">frame</option>
                    <option value="error">error</option>
                  </select>
                  <div class="button-row">
                    <button class="ghost" type="button" id="cowork-log-refresh">Refresh Logs</button>
                  </div>
                  <pre id="cowork-log-output"></pre>
                </div>

              </section>
              <section class="cowork-lane">
                <h3>Autonomous Loop</h3>
                <div class="button-row">
                  <button class="ghost" type="button" id="cowork-live-refresh">Refresh Stream</button>
                  <button class="ghost" type="button" id="cowork-watch-active">Watch Active Task</button>
                  <button class="ghost" type="button" id="cowork-watch-token">Mint LiveKit Token</button>
                </div>
                <div id="cowork-watch-meta" class="cowork-watch-meta">No active watch session.</div>
                <iframe
                  id="cowork-live-iframe"
                  class="cowork-live-frame"
                  title="Agent Live Observer"
                  src="/live.html"
                ></iframe>
                <pre id="watch-output"></pre>
              </section>
            </div>
          </article>

          <article id="compose-panel" class="panel split" data-ide-pane data-ide-label="Compose">
            <section>
              <h2>Login Refresh</h2>
              <form id="login-form">
                <label>Username</label>
                <input id="login-username" type="text" placeholder="your_handle" required />
                <label>Password</label>
                <input id="login-password" type="password" required />
                <label>Email (optional fallback)</label>
                <input id="login-email" type="text" />
                <button type="submit">Refresh Login</button>
              </form>
              <pre id="login-output"></pre>
            </section>
            <section>
              <h2>Tweet Composer</h2>
              <form id="tweet-form">
                <label>Draft</label>
                <textarea id="tweet-text" rows="5" placeholder="Operating from Prompt or Die..." required></textarea>
                <label>Style prompt (for AI draft assist)</label>
                <input id="tweet-style" type="text" placeholder="confident, cryptic, short" />
                <div class="button-row">
                  <button type="button" class="ghost" id="tweet-generate">Generate Draft</button>
                  <button type="submit">Post Tweet</button>
                </div>
              </form>
              <pre id="tweet-output"></pre>
            </section>
          </article>

          <article id="command-studio-panel" class="panel" data-ide-pane data-ide-label="Commands">
            <h2>Command Studio</h2>
            <form id="endpoint-form">
              <label>Search endpoint</label>
              <input id="endpoint-filter" type="text" placeholder="search, stream, spaces, user..." />
              <label>Endpoint</label>
              <select id="endpoint-select"></select>
              <p class="summary" id="endpoint-summary"></p>
              <div id="endpoint-args" class="arg-grid"></div>
              <button type="submit">Run Endpoint</button>
            </form>
          </article>

          <article id="memory-panel" class="panel split" data-ide-pane data-ide-label="Memory">
            <section>
              <h2>Context Inbox</h2>
              <p class="summary">Capture, inspect, and route context into social workflows.</p>
              <div class="button-row">
                <button class="ghost" type="button" id="utility-source-use-selection">Use Selection</button>
                <button class="ghost" type="button" id="utility-source-use-latest">Use Latest</button>
              </div>
              <div id="context-inbox-list" class="context-inbox-list"></div>
            </section>
            <section>
              <h2>Knowledge Shortcuts</h2>
              <label>Source context</label>
              <textarea id="context-rail-source" rows="7" placeholder="Paste or capture context for transforms and tool prefills."></textarea>
              <div class="button-grid utility-transform-grid">
                <button class="ghost" type="button" data-context-transform="tighten">Tighten</button>
                <button class="ghost" type="button" data-context-transform="threadify">Threadify</button>
                <button class="ghost" type="button" data-context-transform="cta">CTA Variant</button>
              </div>
              <div class="button-grid">
                <button class="ghost" type="button" id="utility-prefill-planner">Prefill Planner Goal</button>
                <button class="ghost" type="button" id="utility-prefill-mission">Prefill Mission Query</button>
                <button class="ghost" type="button" id="utility-prefill-command">Prefill Command Studio</button>
                <button class="ghost" type="button" id="utility-archive-knowledge">Archive to Knowledge</button>
              </div>
              <p class="summary" id="context-mode-hint">Context capture ready (Cmd/Ctrl+Shift+K).</p>
              <p class="summary" id="context-feedback-line">Context tools ready.</p>
            </section>
          </article>

          <article id="integrations-panel" class="panel split" data-ide-pane data-ide-label="Integrations">
            <section>
              <h2>Integrations Control</h2>
              <p class="summary">Bridge, subscribers, and live observer controls with direct runtime actions.</p>
              <div class="button-grid">
                <button class="ghost" type="button" id="integrations-center-refresh">Refresh Integrations</button>
                <button class="ghost" type="button" id="integrations-center-bridge">Refresh Bridge</button>
                <button class="ghost" type="button" id="integrations-center-subs">Refresh Subscribers</button>
                <button class="ghost" type="button" id="integrations-center-livekit">Refresh LiveKit</button>
              </div>
              <div class="button-grid">
                <button class="ghost" type="button" id="integrations-center-open-antigravity">Open Antigravity</button>
                <button class="ghost" type="button" id="integrations-center-open-chrome">Open Chrome</button>
                <button class="ghost" type="button" id="integrations-center-open-live-viewer">Expand Live Viewer</button>
              </div>
              <pre id="integrations-center-summary">Integration controls ready.</pre>
            </section>
            <section>
              <h2>Live Observer Snapshot</h2>
              <p class="summary">Latest autonomous loop status and watcher summary.</p>
              <pre id="integrations-center-watch-summary">No active watch session.</pre>
            </section>
          </article>

          <article id="settings-panel" class="panel split" data-ide-pane data-ide-label="Settings">
            <section>
              <h2>Runtime + Preferences</h2>
              <p class="summary">Quick runtime controls, provider status, and onboarding access.</p>
              <div class="button-grid">
                <button class="ghost" type="button" id="settings-center-provider">Refresh Provider Status</button>
                <button class="ghost" type="button" id="settings-center-heartbeat">Refresh Heartbeat</button>
                <button class="ghost" type="button" id="settings-center-heartbeat-run">Run Heartbeat Now</button>
                <button class="ghost" type="button" id="settings-center-onboarding">Reopen Onboarding</button>
              </div>
              <pre id="settings-center-summary">Runtime controls ready.</pre>
            </section>
            <section>
              <h2>Config Hints</h2>
              <p class="summary">Provider mode, extension mode, and local env/export settings are managed from runtime controls.</p>
              <pre id="settings-center-config">Use the left drawer Runtime Controls pane for model lanes, bridge state, and extension toggles.</pre>
            </section>
          </article>

          <article id="dev-workbench-panel" class="panel panel-dev-workbench" data-ide-pane data-ide-label="Dev Workbench">
            <h2>Dev Workbench</h2>
            <p class="summary">
              Unified controls for workspace files, git actions, code execution approvals, and terminal PTY streaming.
            </p>
            <div class="tw-dev-grid">
              <section class="tw-dev-card">
                <div class="tw-dev-card-head">
                  <h3>Workspace Files</h3>
                  <button class="ghost tw-btn-small" type="button" id="dev-workspace-tree-refresh">Refresh Tree</button>
                </div>
                <label>Directory path (workspace-relative)</label>
                <input id="dev-workspace-path" type="text" placeholder="src" />
                <label>Directory entries</label>
                <select id="dev-workspace-entry-select" size="8"></select>
                <div class="button-row">
                  <button class="ghost" type="button" id="dev-workspace-open-entry">Open Selection</button>
                  <button class="ghost" type="button" id="dev-workspace-file-read">Read File</button>
                </div>
                <label>File path</label>
                <input id="dev-workspace-file-path" type="text" placeholder="src/server.ts" />
                <label>File contents</label>
                <textarea id="dev-workspace-file-content" rows="9" spellcheck="false"></textarea>
                <label>Base SHA256</label>
                <input id="dev-workspace-base-sha" type="text" readonly />
                <label>Confirm token</label>
                <input id="dev-workspace-confirm-token" type="text" placeholder="generated by dry run" />
                <div class="button-row">
                  <button class="ghost" type="button" id="dev-workspace-write-dry-run">Dry Run Write</button>
                  <button type="button" id="dev-workspace-write-execute">Execute Write</button>
                </div>
                <pre id="dev-workspace-tree-output"></pre>
                <pre id="dev-workspace-output"></pre>
              </section>

              <section class="tw-dev-card">
                <div class="tw-dev-card-head">
                  <h3>Git Control</h3>
                  <button class="ghost tw-btn-small" type="button" id="dev-git-refresh">Status + Log</button>
                </div>
                <div class="button-row">
                  <button class="ghost" type="button" id="dev-git-status">Status</button>
                  <button class="ghost" type="button" id="dev-git-diff">Diff</button>
                  <button class="ghost" type="button" id="dev-git-log">Log</button>
                </div>
                <label>Diff path filter (optional)</label>
                <input id="dev-git-diff-path" type="text" placeholder="web/index.html" />
                <label>Log limit</label>
                <input id="dev-git-log-limit" type="number" min="1" max="200" value="25" />
                <label>Action</label>
                <select id="dev-git-action">
                  <option value="create_branch">create_branch</option>
                  <option value="commit">commit</option>
                  <option value="push">push</option>
                </select>
                <label>Branch name (create_branch)</label>
                <input id="dev-git-branch-name" type="text" placeholder="codex/feature-ui-integrations" />
                <label>Commit message (commit)</label>
                <input id="dev-git-commit-message" type="text" placeholder="feat(ui): add dev workbench controls" />
                <div class="toggle-row">
                  <label><input id="dev-git-checkout" type="checkbox" checked /> checkout after branch create</label>
                  <label><input id="dev-git-add-all" type="checkbox" checked /> add all before commit</label>
                  <label><input id="dev-git-set-upstream" type="checkbox" checked /> set upstream on push</label>
                </div>
                <label>Confirm token</label>
                <input id="dev-git-confirm-token" type="text" placeholder="generated by dry run" />
                <div class="button-row">
                  <button class="ghost" type="button" id="dev-git-action-dry-run">Dry Run Action</button>
                  <button type="button" id="dev-git-action-execute">Execute Action</button>
                </div>
                <pre id="dev-git-output"></pre>
              </section>

              <section class="tw-dev-card">
                <div class="tw-dev-card-head">
                  <h3>Code Agent</h3>
                  <button class="ghost tw-btn-small" type="button" id="dev-code-refresh">Refresh Code Status</button>
                </div>
                <label>Plan task</label>
                <textarea id="dev-code-plan-task" rows="3" placeholder="Implement safe command execution UI for git + workspace."></textarea>
                <label>Plan context (optional)</label>
                <textarea id="dev-code-plan-context" rows="2" placeholder="Use existing API routes and preserve onboarding constraints."></textarea>
                <button class="ghost" type="button" id="dev-code-plan-run">Generate Code Plan</button>
                <label>Command</label>
                <input id="dev-code-command" type="text" placeholder="bun test test/ui-dashboard-layout.test.ts" />
                <label>CWD (optional)</label>
                <input id="dev-code-cwd" type="text" placeholder="." />
                <button type="button" id="dev-code-exec-run">Run Code Command</button>
                <label>Code approval ID</label>
                <input id="dev-code-approval-id" type="text" placeholder="approval id" />
                <div class="button-row">
                  <button class="ghost" type="button" id="dev-code-approval-refresh">Refresh Approvals</button>
                  <button class="ghost" type="button" id="dev-code-approval-approve">Approve</button>
                  <button class="ghost" type="button" id="dev-code-approval-reject">Reject</button>
                </div>
                <pre id="dev-code-status-output"></pre>
                <pre id="dev-code-output"></pre>
              </section>

              <section class="tw-dev-card">
                <div class="tw-dev-card-head">
                  <h3>Terminal PTY</h3>
                  <button class="ghost tw-btn-small" type="button" id="dev-terminal-refresh">Refresh Sessions</button>
                </div>
                <label>Session CWD (optional)</label>
                <input id="dev-terminal-cwd" type="text" placeholder="." />
                <div class="field-grid">
                  <label>Cols</label>
                  <input id="dev-terminal-cols" type="number" min="20" max="240" value="120" />
                  <label>Rows</label>
                  <input id="dev-terminal-rows" type="number" min="5" max="120" value="34" />
                </div>
                <div class="button-row">
                  <button class="ghost" type="button" id="dev-terminal-create">Create Session</button>
                  <button class="ghost" type="button" id="dev-terminal-connect">Connect Stream</button>
                  <button class="ghost" type="button" id="dev-terminal-close">Close Session</button>
                </div>
                <label>Active session</label>
                <select id="dev-terminal-session-select"></select>
                <label>Terminal input</label>
                <textarea id="dev-terminal-input" rows="2" placeholder="ls -la"></textarea>
                <div class="toggle-row">
                  <label><input id="dev-terminal-input-newline" type="checkbox" checked /> append newline</label>
                </div>
                <button type="button" id="dev-terminal-send">Send Input</button>
                <pre id="dev-terminal-sessions-output"></pre>
                <pre id="dev-terminal-stream-output"></pre>
              </section>
            </div>
          </article>

          <article id="planner-panel" class="panel split" data-ide-pane data-ide-label="Planner">
            <section>
              <h2>AI Workflow Planner</h2>
              <form id="plan-form">
                <label>Goal</label>
                <textarea id="plan-goal" rows="3" placeholder="Monitor trends and capture relevant live posts about AI agents" required></textarea>
                <label>Context (optional)</label>
                <textarea id="plan-context" rows="2"></textarea>
                <label>Text model preset</label>
                <select id="plan-model-select"></select>
                <label>Model override (optional)</label>
                <input id="plan-model" type="text" placeholder="openai/gpt-4.1-mini" />
                <div class="button-row">
                  <button type="submit">Generate Plan</button>
                  <button id="plan-import" type="button" class="ghost">Import Into Runner</button>
                </div>
              </form>
              <pre id="plan-output"></pre>
            </section>

            <section>
              <h2>Workflow Runner</h2>
              <label>Workflow Script</label>
              <textarea id="workflow-json" rows="14">
{
  "stopOnError": true,
  "steps": [
    { "endpoint": "get_my_x_account_detail_v3", "args": {}, "waitMs": 0 },
    { "endpoint": "trends", "args": { "limit": 10 }, "waitMs": 400 },
    { "endpoint": "stream_status", "args": {}, "waitMs": 0 }
  ]
}
              </textarea>
              <div class="button-row">
                <button type="button" id="workflow-run">Run Workflow</button>
                <button type="button" id="workflow-format" class="ghost">Format Script</button>
                <button type="button" id="workflow-clear" class="ghost">Clear</button>
              </div>
              <pre id="workflow-output"></pre>
            </section>
          </article>

          <article id="ai-chat-panel" class="panel split" data-ide-pane data-ide-label="AI Chat">
            <section>
              <h2>AI Chat Copilot</h2>
              <form id="ai-form">
                <label>Text model preset</label>
                <select id="ai-model-select"></select>
                <label>Model (optional)</label>
                <input id="ai-model" type="text" />
                <label>System prompt (optional)</label>
                <textarea id="ai-system" rows="2"></textarea>
                <label>Prompt</label>
                <textarea id="ai-prompt" rows="4" required></textarea>
                <button type="submit">Run AI</button>
              </form>
              <pre id="ai-output"></pre>
            </section>
          </article>

          <article id="media-copilot-panel" class="panel split" data-ide-pane data-ide-label="Media AI">
            <section>
              <h2>AI Image Copilot</h2>
              <form id="ai-image-form">
                <label>Image model preset</label>
                <select id="ai-image-model-select"></select>
                <label>Model override (optional)</label>
                <input id="ai-image-model" type="text" />
                <label>Prompt</label>
                <textarea id="ai-image-prompt" rows="3" placeholder="Generate a visual concept for tonight's X post..." required></textarea>
                <button type="submit">Generate Image</button>
              </form>
              <pre id="ai-image-output"></pre>
            </section>
            <section>
              <h2>AI Video Copilot</h2>
              <form id="ai-video-form">
                <label>Video model preset</label>
                <select id="ai-video-model-select"></select>
                <label>Model override (optional)</label>
                <input id="ai-video-model" type="text" />
                <label>Video URL or Data URL</label>
                <input id="ai-video-url" type="text" placeholder="https://... or data:video/mp4;base64,..." />
                <label>Prompt</label>
                <textarea id="ai-video-prompt" rows="3" placeholder="Summarize this video and output 3 actionable X angles." required></textarea>
                <button type="submit">Analyze Video</button>
              </form>
              <pre id="ai-video-output"></pre>
            </section>
          </article>

          <article id="x-algo-panel" class="panel split" data-ide-pane data-ide-label="X Algo">
            <section>
              <h2>X Algorithm OS Lab</h2>
              <form id="x-algo-form">
                <label>Target handle (optional, empty = active profile)</label>
                <input id="x-algo-handle" type="text" placeholder="@handle or x.com/handle" />
                <label>Draft to score/optimize</label>
                <textarea id="x-algo-draft" rows="4" placeholder="Paste draft to simulate rank potential..." required></textarea>
                <label>Style hint (optional)</label>
                <input id="x-algo-style" type="text" placeholder="concise, high-signal, conversational" />
                <label>Suggested query from algorithm intel</label>
                <select id="x-algo-query-select"></select>
                <div class="toggle-row">
                  <label><input id="x-algo-auto-run" type="checkbox" checked /> auto-run top suggested workflow after intel</label>
                </div>
                <div class="button-row">
                  <button type="submit">Run X Algorithm Intel</button>
                  <button type="button" class="ghost" id="x-algo-apply-best">Use Best Draft in Composer</button>
                  <button type="button" class="ghost" id="x-algo-run-suggested">Run Suggested Query Workflow</button>
                </div>
              </form>
              <pre id="x-algo-output"></pre>
            </section>
            <section>
              <h2>Open-Source Ranking Weights</h2>
              <pre id="x-algo-weights"></pre>
            </section>
          </article>

          <article id="advanced-panel" class="panel split" data-ide-pane data-ide-label="Advanced">
            <section>
              <h2>Advanced Actions</h2>
              <p class="summary">Developer workbench, approvals, and high-control automation actions.</p>
              <div class="button-grid">
                <button class="ghost" type="button" id="advanced-open-dev-workbench">Open Dev Workbench</button>
                <button class="ghost" type="button" id="advanced-open-xalgo">Open X Algo Lab</button>
                <button class="ghost" type="button" id="advanced-refresh-approvals">Refresh Approvals</button>
                <button class="ghost" type="button" id="advanced-refresh-tasks">Refresh Tasks</button>
              </div>
              <pre id="advanced-center-summary">Advanced workspace ready.</pre>
            </section>
            <section>
              <h2>Terminal + Execution</h2>
              <p class="summary">Use the Dev Workbench for PTY sessions, git operations, and code approvals.</p>
              <div class="button-grid">
                <button class="ghost" type="button" id="advanced-open-terminal-sessions">Refresh Terminal Sessions</button>
                <button class="ghost" type="button" id="advanced-open-integration-actions">Open Integration Actions</button>
              </div>
              <pre id="advanced-center-extra">Terminal and integration actions available from docked panels.</pre>
            </section>
          </article>
            </section>
          </section>

          <aside id="dashboard-utility-rail" class="utility-rail ide-inspector" aria-hidden="false">
          <div class="utility-rail-head">
            <h2>Autonomous Loop</h2>
            <button class="ghost" type="button" id="utility-rail-toggle">Collapse</button>
          </div>
          <section class="sub-panel ide-inspector-module">
            <h3 id="ide-current-heading">Current</h3>
            <pre id="ide-task-summary">No task data.</pre>
          </section>
          <section class="sub-panel ide-inspector-module">
            <h3 id="ide-event-heading">Event Stream (0)</h3>
            <pre id="ide-approval-summary">No approval data.</pre>
          </section>
          <section class="sub-panel ide-inspector-module">
            <h3 id="ide-goals-heading">Goals (0)</h3>
            <pre id="ide-watch-summary">No active watch session.</pre>
          </section>
          <section class="sub-panel ide-inspector-module">
            <h3 id="ide-tasks-heading">Tasks (0)</h3>
            <pre id="ide-provider-summary">Provider health unknown.</pre>
          </section>
          </aside>
        </div>

        <section id="ide-bottom-rail" class="ide-bottom-rail">
          <div class="ide-bottom-head">
            <h2>Output</h2>
          </div>
          <div class="ide-bottom-grid">
            <section class="ide-bottom-module">
              <h3>Endpoint Output</h3>
              <pre id="endpoint-output"></pre>
            </section>
            <section class="ide-bottom-module">
              <h3>Activity Log</h3>
              <pre id="activity-log"></pre>
            </section>
            <section class="ide-bottom-module">
              <h3>Error Stream</h3>
              <pre id="ide-error-stream">No renderer errors.</pre>
            </section>
          </div>
        </section>
      </section>
    </main>

    <div id="context-action-picker" class="dashboard-modal-overlay hidden context-picker-overlay" aria-hidden="true">
      <div class="dashboard-modal-card context-picker-card" role="dialog" aria-modal="true" aria-labelledby="context-picker-title">
        <div class="dashboard-modal-head">
          <h3 id="context-picker-title">Send Context</h3>
          <button class="ghost" type="button" id="context-picker-close">Close</button>
        </div>
        <p class="summary" id="context-picker-source">Capture selected text and route to social tools.</p>
        <label>Context</label>
        <textarea id="context-picker-text" rows="6" placeholder="Selected text appears here."></textarea>
        <div class="button-grid context-picker-actions">
          <button class="ghost" type="button" data-context-picker-action="post.append_to_composer">Append to Composer</button>
          <button class="ghost" type="button" data-context-picker-action="post.replace_composer">Replace Composer</button>
          <button class="ghost" type="button" data-context-picker-action="post.build_thread_outline">Build Thread Outline</button>
          <button class="ghost" type="button" data-context-picker-action="tools.prefill_planner_goal">Prefill Planner Goal</button>
          <button class="ghost" type="button" data-context-picker-action="tools.prefill_mission_query">Prefill Mission Query</button>
          <button class="ghost" type="button" data-context-picker-action="tools.prefill_command_studio">Prefill Command Studio</button>
          <button class="ghost" type="button" data-context-picker-action="chat.prefill_prompt">Prefill Chat Prompt</button>
          <button class="ghost" type="button" data-context-picker-action="knowledge.capture">Save to Knowledge Inbox</button>
        </div>
        <div class="button-row">
          <button class="ghost" type="button" id="context-picker-cancel">Cancel</button>
        </div>
      </div>
    </div>

    <div id="desktop-command-palette" class="dashboard-modal-overlay hidden desktop-command-palette-overlay" aria-hidden="true">
      <div
        class="dashboard-modal-card desktop-command-palette-card"
        role="dialog"
        aria-modal="true"
        aria-labelledby="desktop-command-palette-title"
      >
        <div class="dashboard-modal-head">
          <h3 id="desktop-command-palette-title">Command Palette</h3>
          <button class="ghost" type="button" id="desktop-command-palette-close">Close</button>
        </div>
        <p class="summary">Menu + keyboard parity for desktop command execution.</p>
        <input id="desktop-command-search" type="text" placeholder="Search commands..." autocomplete="off" />
        <div id="desktop-command-hint" class="desktop-command-hint">Use â†‘/â†“ to navigate and Enter to run.</div>
        <div id="desktop-command-list" class="desktop-command-list" role="listbox"></div>
      </div>
    </div>

    <div id="live-viewer-modal" class="dashboard-modal-overlay hidden live-viewer-modal-overlay" aria-hidden="true">
      <div class="dashboard-modal-card live-viewer-modal-card" role="dialog" aria-modal="true" aria-labelledby="live-viewer-title">
        <div class="dashboard-modal-head">
          <h3 id="live-viewer-title">Live Observer</h3>
          <button class="ghost" type="button" id="live-viewer-close">Close</button>
        </div>
        <iframe id="live-viewer-iframe" class="live-viewer-iframe" title="Live Observer Expanded" src="/live.html"></iframe>
      </div>
    </div>

    <div id="approval-action-modal" class="dashboard-modal-overlay hidden approval-action-modal-overlay" aria-hidden="true">
      <div class="dashboard-modal-card approval-action-modal-card" role="dialog" aria-modal="true" aria-labelledby="approval-modal-title">
        <div class="dashboard-modal-head">
          <h3 id="approval-modal-title">Approval Required</h3>
          <button class="ghost" type="button" id="approval-modal-close">Close</button>
        </div>
        <p id="approval-modal-summary" class="summary">A guarded action is waiting for approval.</p>
        <div class="approval-modal-meta-grid">
          <div class="approval-modal-meta-item">
            <label>Type</label>
            <code id="approval-modal-type">-</code>
          </div>
          <div class="approval-modal-meta-item">
            <label>Action</label>
            <code id="approval-modal-action">-</code>
          </div>
          <div class="approval-modal-meta-item">
            <label>Reason</label>
            <code id="approval-modal-reason">-</code>
          </div>
        </div>
        <label>Request Details</label>
        <pre id="approval-modal-details"></pre>
        <label class="approval-modal-auto-toggle">
          <input id="approval-modal-auto-toggle" type="checkbox" />
          Don't ask me again for this action (auto-approve)
        </label>
        <p id="approval-modal-auto-hint" class="summary">Auto-approve scope is shown here.</p>
        <div class="button-row">
          <button class="ghost" type="button" id="approval-modal-reject">Reject</button>
          <button type="button" id="approval-modal-approve">Approve</button>
        </div>
      </div>
    </div>

    <script type="module" src="/app.js"></script>
  </body>
</html>
